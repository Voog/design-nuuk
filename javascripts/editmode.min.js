<<<<<<< HEAD
!function(g){function l(e,t){.5<=t?g(e).addClass("light-background").removeClass("dark-background"):g(e).addClass("dark-background").removeClass("light-background")}function a(e,t){return function(a,i){if(a&&i){"string"==typeof a&&(a=a.replace(/rgba?\(/,"").replace(/\)/,"").split(","),g.each(a,function(e,t){a[e]=+t})),"string"==typeof i&&(i=i.replace(/rgba?\(/,"").replace(/\)/,"").split(","),g.each(i,function(e,t){i[e]=+t})),"object"==typeof a&&a.hasOwnProperty("length")&&3==a.length&&a.push(1),"object"==typeof i&&i.hasOwnProperty("length")&&3==i.length&&i.push(1);var e=[0,0,0,0];return e[3]=1-(1-i[3])*(1-a[3]),0===e[3]&&(e[3]=1e-6),e[0]=Math.min(i[0]*i[3]/e[3]+a[0]*a[3]*(1-i[3])/e[3],255),e[1]=Math.min(i[1]*i[3]/e[3]+a[1]*a[3]*(1-i[3])/e[3],255),e[2]=Math.min(i[2]*i[3]/e[3]+a[2]*a[3]*(1-i[3])/e[3],255),g.map(e,function(e){return Math.floor(e)})}}(e||[255,255,255,1],t||[255,255,255,1])}var m=function(e,t){t=a(e,t);return Math.round((.2126*+t[0]+.7152*+t[1]+.0722*+t[2])/2.55)/100},r=function(e,t){e.find(".image_settings").show(),e.removeClass("without-image is-loaded with-error").addClass("with-image not-loaded"),t.removeClass("is-hidden").addClass("is-visible")},c=function(e,t){e.closest(".js-content-item-box").find(".top-inner").append('<div class="edy-img-drop-area-placeholder">'+t+"</div>"),e.closest(".js-content-item-box").find(".top-inner").attr("style",""),e.closest(".js-content-item-box").removeClass("with-image is-loaded with-error").addClass("without-image not-loaded"),e.closest(".js-content-item-box").find(".edy-img-drop-area").removeClass("active"),e.closest(".image_settings").hide(),e.closest(".js-content-item-box").find(".image_settings-remove--input").val(""),e.closest(".js-content-item-box").find(".image_settings-remove--input").trigger("change"),e.closest(".js-content-item-box").find(".form_field-cms").removeClass("with-input"),g(".image_settings").hide()};handleProductImage=function(a,e,i,t){g(".js-buy-btn-content  .partial .edy-buy-button-container").data("component-id");var o=g(".js-buy-btn-content  .partial .edy-buy-button-container").data("product-id"),s=g(".js-product-page-image .image-drop-area");g.ajax({type:"GET",contentType:"application/json",url:"/admin/api/pages/"+e,dataType:"json"}).then(function(t){i?t.data.item_image?(s.css("background-image","url("+t.data.item_image.url+")"),g(".js-remove-image").css("display","flex")):i.detail.product.image?(g(".image_settings").css("display","flex"),g(".js-remove-image").css("display","none"),g(".edy-img-drop-area-placeholder").remove(),r(s.closest(".js-content-item-box"),s.find(".js-toggle-crop-state")),s.css("background-image","url("+i.detail.product.image.url+")")):t.image?(s.css("background-image","url("+t.image.public_url+")"),g(".js-remove-image").css("display","flex")):c(g(".js-product-page-image .image-drop-area"),a):g.ajax({type:"GET",contentType:"application/json",url:"/admin/api/ecommerce/v1/products/"+o+"?include=details",dataType:"json"}).then(function(e){e.image?(g(".image_settings").css("display","flex"),g(".js-remove-image").css("display","none"),g(".edy-img-drop-area-placeholder").remove(),r(s.closest(".js-content-item-box"),s.find(".js-toggle-crop-state")),s.css("background-image","url("+e.image.url+")")):t.image?(s.css("background-image","url("+t.image.public_url+")"),g(".js-remove-image").css("display","flex")):c(g(".js-product-page-image .image-drop-area"),a)})})};window.site=g.extend(window.site||{},{bgPickerPreview:function(t,e,a){var i=t.bg&&t.bg.image||"",o=e.imageSizes?function(e,t){for(var a,i=0,o=e.length;i<o;i++){if(e[i].width<t)return a||e[i];a=e[i]}return e[e.length-1]}(e.imageSizes,g(window).width()):null,s=(e.image&&""!==e.image&&o.url,e.imageSizes&&""!==e.imageSizes?e.imageSizes:null),n=e.color&&""!==e.color?e.color:"rgba(0,0,0,0)",r=(e.colorData&&""!==e.colorData&&e.colorData.lightness,g("<img>")),c=g("<canvas>"),d=e.image&&""!==e.image?e.image:null;d?!function(e,t){for(var a=e.length;a--;)if(-1<t.indexOf(e[a].url.trim()))return!0;return!1}(s,i)?(r.attr("src",d.replace(/.*\/(photos|voogstock)/g,"/photos")),r.on("load",function(){ColorExtract.extract(r[0],c[0],function(e){a.imageColor=e.bgColor||"rgba(255,255,255,1)",a.combinedLightness=m(a.imageColor,n),l(t.picker_area_elem,a.combinedLightness)})})):(a.imageColor=a.imageColor||"rgba(255,255,255,1)",a.combinedLightness=m(a.imageColor,n),l(t.picker_area_elem,a.combinedLightness)):(a.imageColor="rgba(255,255,255,1)",a.combinedLightness=m(a.imageColor,n),l(t.picker_area_elem,a.combinedLightness)),(t.image_elem||t.color_elem)&&(o=g(t.image_elem),s=g(t.color_elem),i=o.closest(t.picker_area_elem),d=e.color&&""!==e.color?e.color:"transparent",e.image?(o.attr("src",e.image),o.attr("srcset",e.image),o.css("display","initial"),t.wrapper_class&&(i.hasClass(t.wrapper_class)||i.addClass(t.wrapper_class))):(o.removeAttr("src"),o.removeAttr("srcset"),o.css("display","none"),t.wrapper_class&&i.hasClass(t.wrapper_class)&&i.removeClass(t.wrapper_class)),d&&s.css("background-color",d))},bgPickerCommit:function(e,t,a,i){var o,s=g.extend(!0,{},t);s.image=t.image||"",s.imageSizes=null==(o=t.imageSizes)||"string"==typeof o&&o.match(/^[\\'"]+$/)?"":o,s.color=t.color||"",s.combinedLightness=a.combinedLightness,"siteData"==i?siteData.set(e,s):"articleData"==i?Edicy.articles.currentArticle.setData(e,s):pageData.set(e,s)},bindContentItemImgDropAreas:function(a,s,n){g(".js-content-item-img-drop-area").each(function(e,t){var i=g(t),o=i.closest(".js-content-item-box"),t=o.find(".image_settings-remove");itemId=o.data("item-id"),itemType=o.data("item-type"),itemImageType=o.data("image-type"),itemData=new Edicy.CustomData({type:itemType,id:itemId});new Edicy.ImgDropArea(i,{positionable:!1,target_width:2048,placeholder:'<div class="edy-img-drop-area-placeholder">'+a+"</div>",removeBtn:'<div class="edy-img-drop-area-remove-image"><div class="edy-img-drop-area-remove-image-ico"><svg width="16" height="20" viewBox="0 0 26 30" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="currentColor"><g transform="translate(2 5)"><path d="M0 .997h2V21c0 1 1 2 2 2h14c1 0 2-1 2-2V1h2v20c0 2.25-1.75 4-4 4H4c-2.25 0-4-1.75-4-4V.997z"/><rect x="10" y="4" width="2" height="16" rx="1"/><rect x="5" y="4" width="2" height="16" rx="1"/><rect x="15" y="4" width="2" height="16" rx="1"/></g><path d="M26 4v2H0V4h7V2c0-1 1-2 2-2h8c1 0 2 1 2 2v2h7zM9 4h8V3c0-.5-.5-1-1-1h-6c-.5 0-1 .5-1 1v1z"/></g></svg></div></div>',change:function(e){var t=o.find(".js-toggle-crop-state");i.removeClass("is-cropped").addClass("not-cropped").css("opacity",.1),e?(r(o,t),g(".js-remove-image").css("display","flex")):(o.find(".image_settings").hide(),o.removeClass("with-image is-loaded with-error").addClass("without-image not-loaded"),t.addClass("is-hidden").removeClass("is-visible"),o.find(".edy-img-drop-area-placeholder").css("opacity",0));var a=o.data("item-type"),t=o.data("item-id");new Edicy.CustomData({type:a,id:t}).set({[n]:"not-cropped",[s]:e}),o.removeClass("not-loaded with-error").addClass("is-loaded"),o.find(".edy-img-drop-area-placeholder").css("opacity",1),i.css("opacity",1)}});t.on("click",function(){var t=g(this);itemData.get({success:function(e){e.item_image?itemData.remove(s,{success:function(e){itemData.remove(n,{success:function(e){"article"!==itemType?handleProductImage(a,itemId,null,itemData):c(t,a)}})}}):g.ajax({type:"PUT",contentType:"application/json",url:"/admin/api/pages/"+itemId,dataType:"json",data:JSON.stringify({image_id:null})}).then(function(e){c(t,a)})}})})})},bindContentItemImageCropToggle:function(i){g(".js-toggle-crop-state").on("click",function(){var e=g(this).closest(".js-content-item-box"),t=e.find(".js-content-item-img-drop-area"),a=e.data("item-id"),e=e.data("item-type"),a=new Edicy.CustomData({type:e,id:a}),t=t.hasClass("is-cropped")?(t.removeClass("is-cropped").addClass("not-cropped"),"not-cropped"):(t.removeClass("not-cropped").addClass("is-cropped"),"is-cropped");a.set(i,t)})},bindProductListeners:function(t,a){document.addEventListener("voog:ecommerce:buttonproductsave",function(e){handleProductImage(t,a,e)})},initSettingsEditorBtn:function(){window.addEventListener("DOMContentLoaded",function(e){var d=document.querySelector(".edy-next-shadowdom").shadowRoot,l=setInterval(function(){var e,t,i,a,o,s,n,r,c;d.querySelectorAll('div[class^="toolbar__"]').length&&(e=d.querySelector('div[class^="toolbar-expand"]'),t=d.querySelector('div[class^="toolbar__"]'),i=document.querySelector(".js-layout_settings-btn"),a=d.querySelector('div[class^="toolbar-content-item__"]'),i.className=a.className+" "+i.className,t.insertBefore(i,e),d.querySelector(".js-layout_settings-btn").addEventListener("click",function(e){console.log("Enter"),document.querySelector("body").classList.toggle("layout_settings-visible"),e.stopImmediatePropagation()}),d.querySelector(".js-layout_settings-btn").addEventListener("mouseenter",function(e){g(".layout_settings-tooltip").addClass("visible"),o(),console.log("Hover"),console.log(i.getBoundingClientRect())}),d.querySelector(".js-layout_settings-btn").addEventListener("mouseleave",function(e){console.log("mouseleacve"),g(".layout_settings-tooltip").removeClass("visible")}),o=function(){var e=g(".js-layout_settings-popover"),t=g(".layout_settings-arrow"),a=g(".layout_settings-tooltip");768<g(window).width()?(e.css({right:window.innerWidth-i.getBoundingClientRect().right-e.width()/2}),a.css({right:window.innerWidth-i.getBoundingClientRect().right-a.width()/2-i.getBoundingClientRect().width/2}),t.css({right:e.width()/2})):(e.css({right:0}),a.css({right:0}),t.css({right:72}))},g(window).resize((s=function(){o()},n=25,function(){var e=this,t=arguments,a=r&&!c;clearTimeout(c),c=setTimeout(function(){c=null,r||s.apply(e,t)},n),a&&s.apply(e,t)})),o(),clearInterval(l))},500);g("body").append(g(".js-layout_settings-popover"))})}}),window.edy=window.edy||[],edy.push(["texteditorStyles",{name:"Button",tagname:"a",attribute:{href:"#"},classname:"custom-btn",toggle:!0}]),g(".js-data-item").each(function(){g(this).on("change",function(e){var t;t="checkbox"===e.target.type?e.target.checked:e.target.value;var a=e.target.dataset.name,i=e.target.dataset.id,o=e.target.dataset.entity,s=e.target.dataset.reload;("site"==o?new Edicy.CustomData({type:"site"}):new Edicy.CustomData({type:o,id:i})).set({[a]:t},{success:function(){s&&location.reload()}})})})}(jQuery);
=======
!function(g){function l(e,t){.5<=t?g(e).addClass("light-background").removeClass("dark-background"):g(e).addClass("dark-background").removeClass("light-background")}function a(e,t){return function(a,i){if(a&&i){"string"==typeof a&&(a=a.replace(/rgba?\(/,"").replace(/\)/,"").split(","),g.each(a,function(e,t){a[e]=+t})),"string"==typeof i&&(i=i.replace(/rgba?\(/,"").replace(/\)/,"").split(","),g.each(i,function(e,t){i[e]=+t})),"object"==typeof a&&a.hasOwnProperty("length")&&3==a.length&&a.push(1),"object"==typeof i&&i.hasOwnProperty("length")&&3==i.length&&i.push(1);var e=[0,0,0,0];return e[3]=1-(1-i[3])*(1-a[3]),0===e[3]&&(e[3]=1e-6),e[0]=Math.min(i[0]*i[3]/e[3]+a[0]*a[3]*(1-i[3])/e[3],255),e[1]=Math.min(i[1]*i[3]/e[3]+a[1]*a[3]*(1-i[3])/e[3],255),e[2]=Math.min(i[2]*i[3]/e[3]+a[2]*a[3]*(1-i[3])/e[3],255),g.map(e,function(e){return Math.floor(e)})}}(e||[255,255,255,1],t||[255,255,255,1])}var m=function(e,t){t=a(e,t);return Math.round((.2126*+t[0]+.7152*+t[1]+.0722*+t[2])/2.55)/100},d=function(e,t){e.find(".image_settings").show(),e.removeClass("without-image is-loaded with-error").addClass("with-image not-loaded"),t.removeClass("is-hidden").addClass("is-visible")},p=function(e,t){e=e.closest(".js-content-item-box");e.find(".top-inner").append('<div class="edy-img-drop-area-placeholder">'+t+"</div>"),e.find(".top-inner").attr("style",""),e.removeClass("with-image is-loaded with-error").addClass("without-image not-loaded"),e.find(".edy-img-drop-area").removeClass("active"),e.find(".image_settings").hide(),e.find(".image_settings-remove--input").val(""),e.find(".image_settings-remove--input").trigger("change"),e.find(".form_field-cms").removeClass("with-input")};handleProductImage=function(e,t,i,o){var s=g(".js-buy-btn-content  .partial .edy-buy-button-container").data("product-id"),r=g(".js-product-page-image .image-drop-area");g.ajax({type:"GET",contentType:"application/json",url:"/admin/api/pages/"+t,dataType:"json"}).then(function(t){function a(){o.closest(".content-item-box").find(".edy-img-drop-area-placeholder").length<1&&p(o,e)}i?t.data.item_image?(r.css("background-image","url("+t.data.item_image.url+")"),g(".js-remove-image").css("display","flex")):i.detail.product.image?(g(".image_settings").css("display","flex"),g(".js-remove-image").css("display","none"),g(".edy-img-drop-area-placeholder").remove(),d(r.closest(".js-content-item-box"),r.find(".js-toggle-crop-state")),r.css("background-image","url("+i.detail.product.image.url+")")):n(t.image)?g(".edy-img-drop-area-placeholder").length<1&&p(r,e):(r.css("background-image","url("+t.image.public_url+")"),g(".js-remove-image").css("display","flex")):s?g.ajax({type:"GET",contentType:"application/json",url:"/admin/api/ecommerce/v1/products/"+s+"?include=details",dataType:"json"}).then(function(e){e.image?(g(".image_settings").css("display","flex"),g(".js-remove-image").css("display","none"),g(".edy-img-drop-area-placeholder").remove(),d(r.closest(".js-content-item-box"),r.find(".js-toggle-crop-state")),r.css("background-image","url("+e.image.url+")")):n(t.image)?a():(r.css("background-image","url("+t.image.public_url+")"),g(".js-remove-image").css("display","flex"))}):a()})};var n=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return JSON.stringify(e)===JSON.stringify({})};window.site=g.extend(window.site||{},{bgPickerPreview:function(t,e,a){var i=t.bg&&t.bg.image||"",o=e.imageSizes?function(e,t){for(var a,i=0,o=e.length;i<o;i++){if(e[i].width<t)return a||e[i];a=e[i]}return e[e.length-1]}(e.imageSizes,g(window).width()):null,s=(e.image&&""!==e.image&&o.url,e.imageSizes&&""!==e.imageSizes?e.imageSizes:null),r=e.color&&""!==e.color?e.color:"rgba(0,0,0,0)",n=(e.colorData&&""!==e.colorData&&e.colorData.lightness,g("<img>")),c=g("<canvas>"),d=e.image&&""!==e.image?e.image:null;d?!function(e,t){for(var a=e.length;a--;)if(-1<t.indexOf(e[a].url.trim()))return!0;return!1}(s,i)?(n.attr("src",d.replace(/.*\/(photos|voogstock)/g,"/photos")),n.on("load",function(){ColorExtract.extract(n[0],c[0],function(e){a.imageColor=e.bgColor||"rgba(255,255,255,1)",a.combinedLightness=m(a.imageColor,r),l(t.picker_area_elem,a.combinedLightness)})})):(a.imageColor=a.imageColor||"rgba(255,255,255,1)",a.combinedLightness=m(a.imageColor,r),l(t.picker_area_elem,a.combinedLightness)):(a.imageColor="rgba(255,255,255,1)",a.combinedLightness=m(a.imageColor,r),l(t.picker_area_elem,a.combinedLightness)),(t.image_elem||t.color_elem)&&(o=g(t.image_elem),s=g(t.color_elem),i=o.closest(t.picker_area_elem),d=e.color&&""!==e.color?e.color:"transparent",e.image?(o.attr("src",e.image),o.attr("srcset",e.image),o.css("display","initial"),t.wrapper_class&&(i.hasClass(t.wrapper_class)||i.addClass(t.wrapper_class))):(o.removeAttr("src"),o.removeAttr("srcset"),o.css("display","none"),t.wrapper_class&&i.hasClass(t.wrapper_class)&&i.removeClass(t.wrapper_class)),d&&s.css("background-color",d))},bgPickerCommit:function(e,t,a,i){var o,s=g.extend(!0,{},t);s.image=t.image||"",s.imageSizes=null==(o=t.imageSizes)||"string"==typeof o&&o.match(/^[\\'"]+$/)?"":o,s.color=t.color||"",s.combinedLightness=a.combinedLightness,"siteData"==i?siteData.set(e,s):"articleData"==i?Edicy.articles.currentArticle.setData(e,s):pageData.set(e,s)},bindContentItemImgDropAreas:function(r,n,c){g(".js-content-item-img-drop-area").each(function(e,t){var i=g(t),s=i.closest(".js-content-item-box"),t=s.find(".image_settings-remove");itemId=s.data("item-id"),itemType=s.data("item-type"),itemImageType=s.data("image-type"),itemData=new Edicy.CustomData({type:itemType,id:itemId});new Edicy.ImgDropArea(i,{positionable:!1,target_width:2048,placeholder:'<div class="edy-img-drop-area-placeholder">'+r+"</div>",removeBtn:'<div class="edy-img-drop-area-remove-image"><div class="edy-img-drop-area-remove-image-ico"><svg width="16" height="20" viewBox="0 0 26 30" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="currentColor"><g transform="translate(2 5)"><path d="M0 .997h2V21c0 1 1 2 2 2h14c1 0 2-1 2-2V1h2v20c0 2.25-1.75 4-4 4H4c-2.25 0-4-1.75-4-4V.997z"/><rect x="10" y="4" width="2" height="16" rx="1"/><rect x="5" y="4" width="2" height="16" rx="1"/><rect x="15" y="4" width="2" height="16" rx="1"/></g><path d="M26 4v2H0V4h7V2c0-1 1-2 2-2h8c1 0 2 1 2 2v2h7zM9 4h8V3c0-.5-.5-1-1-1h-6c-.5 0-1 .5-1 1v1z"/></g></svg></div></div>',change:function(e){var t=s.find(".js-toggle-crop-state");i.removeClass("is-cropped").addClass("not-cropped").css("opacity",.1),e?(d(s,t),g(".js-remove-image").css("display","flex")):(s.find(".image_settings").hide(),s.removeClass("with-image is-loaded with-error").addClass("without-image not-loaded"),t.addClass("is-hidden").removeClass("is-visible"),s.find(".edy-img-drop-area-placeholder").css("opacity",0));var a=s.data("item-type"),t=s.data("item-id");new Edicy.CustomData({type:a,id:t}).set({[c]:"not-cropped",[n]:e}),s.removeClass("not-loaded with-error").addClass("is-loaded"),s.find(".edy-img-drop-area-placeholder").css("opacity",1),i.css("opacity",1)}});t.on("click",function(){var t=g(this),a=s.data("item-id"),i=s.data("item-type"),o=new Edicy.CustomData({type:i,id:a});o.get({success:function(e){e.item_image?o.remove(n,{success:function(e){o.remove(c,{success:function(e){"article"!==i?handleProductImage(r,a,null,t):p(t,r)}})}}):g.ajax({type:"PUT",contentType:"application/json",url:"/admin/api/pages/"+a,dataType:"json",data:JSON.stringify({image_id:null})}).then(function(e){p(t,r)})}})})})},bindContentItemImageCropToggle:function(i){g(".js-toggle-crop-state").on("click",function(){var e=g(this).closest(".js-content-item-box"),t=e.find(".js-content-item-img-drop-area"),a=e.data("item-id"),e=e.data("item-type"),a=new Edicy.CustomData({type:e,id:a}),t=t.hasClass("is-cropped")?(t.removeClass("is-cropped").addClass("not-cropped"),"not-cropped"):(t.removeClass("not-cropped").addClass("is-cropped"),"is-cropped");a.set(i,t)})},bindProductListeners:function(t,a){document.addEventListener("voog:ecommerce:buttonproductsave",function(e){handleProductImage(t,a,e)})},initSettingsEditorBtn:function(){window.addEventListener("DOMContentLoaded",function(e){var d=document.querySelector(".edy-next-shadowdom").shadowRoot,l=setInterval(function(){var e,t,a,i,o,s,r,n,c;d.querySelectorAll('div[class^="toolbar__"]').length&&(e=d.querySelector('div[class^="toolbar-expand"]'),t=d.querySelector('div[class^="toolbar__"]'),a=document.querySelector(".js-layout_settings-btn"),i=d.querySelector('div[class^="toolbar-content-item__"]'),a.className=i.className+" "+a.className,t.insertBefore(a,e),d.querySelector(".js-layout_settings-btn").addEventListener("click",function(e){document.querySelector("body").classList.toggle("layout_settings-visible"),e.stopImmediatePropagation()}),o=function(){var e=g(".js-layout_settings-popover"),t=g(".layout_settings-arrow");768<g(window).width()?(e.css({right:window.innerWidth-a.getBoundingClientRect().right-e.width()/2}),t.css({right:e.width()/2})):(e.css({right:0}),t.css({right:72}))},g(window).resize((s=function(){o()},r=25,function(){var e=this,t=arguments,a=n&&!c;clearTimeout(c),c=setTimeout(function(){c=null,n||s.apply(e,t)},r),a&&s.apply(e,t)})),o(),clearInterval(l))},500);g("body").append(g(".js-layout_settings-popover"))})}}),window.edy=window.edy||[],edy.push(["texteditorStyles",{name:"Button",tagname:"a",attribute:{href:"#"},classname:"custom-btn",toggle:!0}]),g(".js-data-item").each(function(){g(this).on("change",function(e){var t;t="checkbox"===e.target.type?e.target.checked:e.target.value;var a=e.target.dataset.name,i=e.target.dataset.id,o=e.target.dataset.entity,s=e.target.dataset.reload;("site"==o?new Edicy.CustomData({type:"site"}):new Edicy.CustomData({type:o,id:i})).set({[a]:t},{success:function(){s&&location.reload()}})})})}(jQuery);
>>>>>>> master
